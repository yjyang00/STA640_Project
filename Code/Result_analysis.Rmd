---
title: "Result_analysis"
author: "Yicheng Shen"
date: "2023-04-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
ggplot2::theme_set(ggplot2::theme_bw())
knitr::opts_chunk$set(out.width = "100%", fig.align = 'center')
```


```{r}
load("bias_result.Rdata")
```

```{r}
bias_result %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)


bias_result %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>% 
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)
```


```{r}
bias_result %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type!="OLS_bias") %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)


bias_result %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type!="OLS_bias") %>% 
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)
```


```{r}
load("bias_result_uniform.Rdata")
```

```{r}
bias_result_uniform %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() 


bias_result_uniform %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>% 
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() 



bias_result_uniform %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type!="OLS_bias") %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() 


bias_result_uniform %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type!="OLS_bias") %>% 
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() 
```


```{r}
load("bias_result_full.RData")
bias_result_full$confound_treatment = factor(bias_result_full$confound_treatment)
levels(bias_result_full$confound_treatment)[levels(bias_result_full$confound_treatment)=="Uniform"] <- "Very Strong"


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(rho == 8) %>%
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(gamma == 8) %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)



bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias", rho == 5) %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias", gamma == 5) %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)
```

```{r}
bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(rho == 8) %>%
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(gamma == 8) %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)



bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias") %>% 
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias") %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)
```


```{r}

bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias") %>%
  ggplot(aes(x = gamma, y = Bias, color = Bias_Type, alpha = rho)) + geom_point() + facet_wrap(~confound_treatment)

bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type != "OLS_bias") %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type, alpha = gamma)) + geom_point() + facet_wrap(~confound_treatment)


bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type %in% c("DID_bias","FE_bias")) %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + facet_wrap(~confound_treatment)

bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type %in% c("DID_bias","FE_bias"), gamma == 8) %>%
  ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)
```

```{r}
bias_result_full %>% pivot_longer(cols = c("DID_bias","OLS_bias","FE_bias", "RE_bias"), names_to = "Bias_Type", values_to = "Bias") %>%
  filter(Bias_Type %in% c("FE_bias","RE_bias"), gamma == 10) %>%   ggplot(aes(x = rho, y = Bias, color = Bias_Type)) + geom_point() + geom_line() + facet_wrap(~confound_treatment)
```

